<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.github.congyh.seckill.dao.SeckillOrderDAO">
    <resultMap id="seckillOrder" type="com.github.congyh.seckill.domain.SeckillOrderDO">
        <result column="id" property="id"/>
        <result column="seckill_product_id" property="seckillProductId"/>
        <result column="user_phone" property="userPhone"/>
        <result column="order_status" property="orderStatus"/>
        <result column="gmt_create" property="gmtCreate"/>
        <result column="gmt_modified" property="gmtModified"/>
    </resultMap>

    <insert id="save">
        INSERT IGNORE INTO seckill.seckill_order(seckill_product_id, user_phone)
                VALUES (#{seckillProductId}, #{userPhone})
    </insert>

    <select id="findByIdAndPhone" resultMap="seckillOrder">
        select id, seckill_product_id, user_phone, order_status, gmt_create, gmt_modified
            FROM seckill.seckill_order
        WHERE seckill_product_id = #{seckillProductId}
        AND user_phone = #{userPhone}
    </select>
</mapper>

